# EVM Opcode Registry - Yellow Paper Appendix H
# Version: Cancun (EIP-4844)
# Reference: https://www.evm.codes/

version: cancun

# Gas cost constants (Yellow Paper Appendix G)
constants:
  Gzero: 0
  Gbase: 2
  Gverylow: 3
  Glow: 5
  Gmid: 8
  Ghigh: 10
  Gextcode: 100        # DEPRECATED: Use access list costs
  Gbalance: 100        # DEPRECATED: Use access list costs
  Gsload: 100          # DEPRECATED: Use access list costs
  Gjumpdest: 1
  Gsset: 20000         # Storage set (zero to non-zero)
  Gsreset: 2900        # Storage reset (non-zero to non-zero)
  Rsclear: 4800        # Refund for clearing storage
  Rselfdestruct: 24000 # Refund for selfdestruct
  Gselfdestruct: 5000
  Gcreate: 32000
  Gcodedeposit: 200    # Per byte of deployed code
  Gcall: 100           # DEPRECATED: Base for CALL
  Gcallvalue: 9000     # Extra for CALL with value transfer
  Gcallstipend: 2300   # Stipend for called contract
  Gnewaccount: 25000   # Creating new account
  Gexp: 10             # Base for EXP
  Gexpbyte: 50         # Per byte in exponent
  Gmemory: 3           # Per word of memory
  Gtxcreate: 32000     # Contract creation via tx
  Gtxdatazero: 4       # Per zero byte of tx data
  Gtxdatanonzero: 16   # Per non-zero byte of tx data
  Gtransaction: 21000  # Base transaction cost
  Glog: 375            # Per LOG operation
  Glogdata: 8          # Per byte of LOG data
  Glogtopic: 375       # Per topic in LOG
  Gkeccak256: 30       # Per KECCAK256 operation
  Gkeccak256word: 6    # Per word (32 bytes) of KECCAK256 input
  Gcopy: 3             # Per word for COPY operations
  Gblockhash: 20

  # EIP-2929 Access list costs
  Gcoldaccountaccess: 2600
  Gcoldslotaccess: 2100
  Gwarmaccess: 100

categories:
  stop_arithmetic:
    description: "Stop and arithmetic operations (0x00-0x0b)"
    opcodes:
      - opcode: 0x00
        name: STOP
        gas: 0
        stack_in: 0
        stack_out: 0
        description: "Halts execution"
        geth_func: opStop

      - opcode: 0x01
        name: ADD
        gas: 3
        stack_in: 2
        stack_out: 1
        description: "Addition operation"
        formula: "(a + b) mod 2^256"
        geth_func: opAdd

      - opcode: 0x02
        name: MUL
        gas: 5
        stack_in: 2
        stack_out: 1
        description: "Multiplication operation"
        formula: "(a * b) mod 2^256"
        geth_func: opMul

      - opcode: 0x03
        name: SUB
        gas: 3
        stack_in: 2
        stack_out: 1
        description: "Subtraction operation"
        formula: "(a - b) mod 2^256"
        geth_func: opSub

      - opcode: 0x04
        name: DIV
        gas: 5
        stack_in: 2
        stack_out: 1
        description: "Integer division operation"
        formula: "floor(a / b) if b != 0 else 0"
        geth_func: opDiv

      - opcode: 0x05
        name: SDIV
        gas: 5
        stack_in: 2
        stack_out: 1
        description: "Signed integer division"
        formula: "sign(a/b) * floor(|a| / |b|) if b != 0 else 0"
        geth_func: opSdiv

      - opcode: 0x06
        name: MOD
        gas: 5
        stack_in: 2
        stack_out: 1
        description: "Modulo operation"
        formula: "a mod b if b != 0 else 0"
        geth_func: opMod

      - opcode: 0x07
        name: SMOD
        gas: 5
        stack_in: 2
        stack_out: 1
        description: "Signed modulo operation"
        formula: "sign(a) * (|a| mod |b|) if b != 0 else 0"
        geth_func: opSmod

      - opcode: 0x08
        name: ADDMOD
        gas: 8
        stack_in: 3
        stack_out: 1
        description: "Modulo addition"
        formula: "(a + b) mod N if N != 0 else 0"
        geth_func: opAddmod

      - opcode: 0x09
        name: MULMOD
        gas: 8
        stack_in: 3
        stack_out: 1
        description: "Modulo multiplication"
        formula: "(a * b) mod N if N != 0 else 0"
        geth_func: opMulmod

      - opcode: 0x0a
        name: EXP
        gas_formula: "10 + 50 * byte_length(exponent)"
        stack_in: 2
        stack_out: 1
        description: "Exponential operation"
        formula: "a^b mod 2^256"
        geth_func: opExp

      - opcode: 0x0b
        name: SIGNEXTEND
        gas: 5
        stack_in: 2
        stack_out: 1
        description: "Extend length of two's complement signed integer"
        geth_func: opSignExtend

  comparison_bitwise:
    description: "Comparison and bitwise logic (0x10-0x1d)"
    opcodes:
      - opcode: 0x10
        name: LT
        gas: 3
        stack_in: 2
        stack_out: 1
        description: "Less-than comparison"
        formula: "1 if a < b else 0"
        geth_func: opLt

      - opcode: 0x11
        name: GT
        gas: 3
        stack_in: 2
        stack_out: 1
        description: "Greater-than comparison"
        formula: "1 if a > b else 0"
        geth_func: opGt

      - opcode: 0x12
        name: SLT
        gas: 3
        stack_in: 2
        stack_out: 1
        description: "Signed less-than comparison"
        geth_func: opSlt

      - opcode: 0x13
        name: SGT
        gas: 3
        stack_in: 2
        stack_out: 1
        description: "Signed greater-than comparison"
        geth_func: opSgt

      - opcode: 0x14
        name: EQ
        gas: 3
        stack_in: 2
        stack_out: 1
        description: "Equality comparison"
        formula: "1 if a == b else 0"
        geth_func: opEq

      - opcode: 0x15
        name: ISZERO
        gas: 3
        stack_in: 1
        stack_out: 1
        description: "Simple not operator"
        formula: "1 if a == 0 else 0"
        geth_func: opIszero

      - opcode: 0x16
        name: AND
        gas: 3
        stack_in: 2
        stack_out: 1
        description: "Bitwise AND operation"
        formula: "a & b"
        geth_func: opAnd

      - opcode: 0x17
        name: OR
        gas: 3
        stack_in: 2
        stack_out: 1
        description: "Bitwise OR operation"
        formula: "a | b"
        geth_func: opOr

      - opcode: 0x18
        name: XOR
        gas: 3
        stack_in: 2
        stack_out: 1
        description: "Bitwise XOR operation"
        formula: "a ^ b"
        geth_func: opXor

      - opcode: 0x19
        name: NOT
        gas: 3
        stack_in: 1
        stack_out: 1
        description: "Bitwise NOT operation"
        formula: "~a (all bits flipped)"
        geth_func: opNot

      - opcode: 0x1a
        name: BYTE
        gas: 3
        stack_in: 2
        stack_out: 1
        description: "Retrieve single byte from word"
        formula: "(x >> (248 - i*8)) & 0xFF"
        geth_func: opByte

      - opcode: 0x1b
        name: SHL
        gas: 3
        stack_in: 2
        stack_out: 1
        description: "Shift left"
        formula: "(value << shift) mod 2^256"
        eip: 145
        geth_func: opSHL

      - opcode: 0x1c
        name: SHR
        gas: 3
        stack_in: 2
        stack_out: 1
        description: "Logical shift right"
        formula: "value >> shift"
        eip: 145
        geth_func: opSHR

      - opcode: 0x1d
        name: SAR
        gas: 3
        stack_in: 2
        stack_out: 1
        description: "Arithmetic shift right"
        formula: "value >> shift (sign extended)"
        eip: 145
        geth_func: opSAR

  keccak256:
    description: "SHA3/Keccak256 (0x20)"
    opcodes:
      - opcode: 0x20
        name: KECCAK256
        gas_formula: "30 + 6 * ceil(size / 32)"
        stack_in: 2
        stack_out: 1
        description: "Compute Keccak-256 hash"
        inputs: "[offset, size]"
        geth_func: opKeccak256

  environmental:
    description: "Environmental information (0x30-0x3f)"
    opcodes:
      - opcode: 0x30
        name: ADDRESS
        gas: 2
        stack_in: 0
        stack_out: 1
        description: "Get address of currently executing account"
        geth_func: opAddress

      - opcode: 0x31
        name: BALANCE
        gas:
          cold: 2600
          warm: 100
        stack_in: 1
        stack_out: 1
        description: "Get balance of the given account"
        eip: 2929
        geth_func: opBalance

      - opcode: 0x32
        name: ORIGIN
        gas: 2
        stack_in: 0
        stack_out: 1
        description: "Get execution origination address (tx.origin)"
        geth_func: opOrigin

      - opcode: 0x33
        name: CALLER
        gas: 2
        stack_in: 0
        stack_out: 1
        description: "Get caller address (msg.sender)"
        geth_func: opCaller

      - opcode: 0x34
        name: CALLVALUE
        gas: 2
        stack_in: 0
        stack_out: 1
        description: "Get deposited value by instruction/transaction (msg.value)"
        geth_func: opCallValue

      - opcode: 0x35
        name: CALLDATALOAD
        gas: 3
        stack_in: 1
        stack_out: 1
        description: "Get input data of current environment"
        geth_func: opCallDataLoad

      - opcode: 0x36
        name: CALLDATASIZE
        gas: 2
        stack_in: 0
        stack_out: 1
        description: "Get size of input data in current environment"
        geth_func: opCallDataSize

      - opcode: 0x37
        name: CALLDATACOPY
        gas_formula: "3 + 3 * ceil(size / 32) + memory_expansion"
        stack_in: 3
        stack_out: 0
        description: "Copy input data to memory"
        inputs: "[destOffset, offset, size]"
        geth_func: opCallDataCopy

      - opcode: 0x38
        name: CODESIZE
        gas: 2
        stack_in: 0
        stack_out: 1
        description: "Get size of code running in current environment"
        geth_func: opCodeSize

      - opcode: 0x39
        name: CODECOPY
        gas_formula: "3 + 3 * ceil(size / 32) + memory_expansion"
        stack_in: 3
        stack_out: 0
        description: "Copy code to memory"
        inputs: "[destOffset, offset, size]"
        geth_func: opCodeCopy

      - opcode: 0x3a
        name: GASPRICE
        gas: 2
        stack_in: 0
        stack_out: 1
        description: "Get price of gas in current environment"
        geth_func: opGasprice

      - opcode: 0x3b
        name: EXTCODESIZE
        gas:
          cold: 2600
          warm: 100
        stack_in: 1
        stack_out: 1
        description: "Get size of an account's code"
        eip: 2929
        geth_func: opExtCodeSize

      - opcode: 0x3c
        name: EXTCODECOPY
        gas_formula: "access_cost + 3 * ceil(size / 32) + memory_expansion"
        gas:
          cold: 2600
          warm: 100
        stack_in: 4
        stack_out: 0
        description: "Copy an account's code to memory"
        inputs: "[address, destOffset, offset, size]"
        eip: 2929
        geth_func: opExtCodeCopy

      - opcode: 0x3d
        name: RETURNDATASIZE
        gas: 2
        stack_in: 0
        stack_out: 1
        description: "Get size of output data from previous call"
        eip: 211
        geth_func: opReturnDataSize

      - opcode: 0x3e
        name: RETURNDATACOPY
        gas_formula: "3 + 3 * ceil(size / 32) + memory_expansion"
        stack_in: 3
        stack_out: 0
        description: "Copy output data from previous call to memory"
        inputs: "[destOffset, offset, size]"
        eip: 211
        geth_func: opReturnDataCopy

      - opcode: 0x3f
        name: EXTCODEHASH
        gas:
          cold: 2600
          warm: 100
        stack_in: 1
        stack_out: 1
        description: "Get hash of an account's code"
        eip: 1052
        geth_func: opExtCodeHash

  block_info:
    description: "Block information (0x40-0x48)"
    opcodes:
      - opcode: 0x40
        name: BLOCKHASH
        gas: 20
        stack_in: 1
        stack_out: 1
        description: "Get hash of most recent 256 complete blocks"
        geth_func: opBlockhash

      - opcode: 0x41
        name: COINBASE
        gas: 2
        stack_in: 0
        stack_out: 1
        description: "Get block's beneficiary address"
        geth_func: opCoinbase

      - opcode: 0x42
        name: TIMESTAMP
        gas: 2
        stack_in: 0
        stack_out: 1
        description: "Get block's timestamp"
        geth_func: opTimestamp

      - opcode: 0x43
        name: NUMBER
        gas: 2
        stack_in: 0
        stack_out: 1
        description: "Get block's number"
        geth_func: opNumber

      - opcode: 0x44
        name: PREVRANDAO
        gas: 2
        stack_in: 0
        stack_out: 1
        description: "Get previous block's RANDAO mix (post-merge)"
        note: "Was DIFFICULTY pre-merge"
        eip: 4399
        geth_func: opRandom

      - opcode: 0x45
        name: GASLIMIT
        gas: 2
        stack_in: 0
        stack_out: 1
        description: "Get block's gas limit"
        geth_func: opGasLimit

      - opcode: 0x46
        name: CHAINID
        gas: 2
        stack_in: 0
        stack_out: 1
        description: "Get chain ID"
        eip: 1344
        geth_func: opChainID

      - opcode: 0x47
        name: SELFBALANCE
        gas: 5
        stack_in: 0
        stack_out: 1
        description: "Get balance of currently executing account"
        eip: 1884
        geth_func: opSelfBalance

      - opcode: 0x48
        name: BASEFEE
        gas: 2
        stack_in: 0
        stack_out: 1
        description: "Get block's base fee"
        eip: 3198
        geth_func: opBaseFee

      - opcode: 0x49
        name: BLOBHASH
        gas: 3
        stack_in: 1
        stack_out: 1
        description: "Get versioned hash at index from current tx"
        eip: 4844
        geth_func: opBlobHash

      - opcode: 0x4a
        name: BLOBBASEFEE
        gas: 2
        stack_in: 0
        stack_out: 1
        description: "Get current block's blob base fee"
        eip: 7516
        geth_func: opBlobBaseFee

  stack_memory_storage:
    description: "Stack, memory, storage, and flow operations (0x50-0x5f)"
    opcodes:
      - opcode: 0x50
        name: POP
        gas: 2
        stack_in: 1
        stack_out: 0
        description: "Remove item from stack"
        geth_func: opPop

      - opcode: 0x51
        name: MLOAD
        gas_formula: "3 + memory_expansion"
        stack_in: 1
        stack_out: 1
        description: "Load word from memory"
        geth_func: opMload

      - opcode: 0x52
        name: MSTORE
        gas_formula: "3 + memory_expansion"
        stack_in: 2
        stack_out: 0
        description: "Store word to memory"
        geth_func: opMstore

      - opcode: 0x53
        name: MSTORE8
        gas_formula: "3 + memory_expansion"
        stack_in: 2
        stack_out: 0
        description: "Store byte to memory"
        geth_func: opMstore8

      - opcode: 0x54
        name: SLOAD
        gas:
          cold: 2100
          warm: 100
        stack_in: 1
        stack_out: 1
        description: "Load word from storage"
        eip: 2929
        geth_func: opSload

      - opcode: 0x55
        name: SSTORE
        gas_schedule:
          no_op: 100                    # Value unchanged, warm slot
          clean_init: 22100             # Cold slot, zero to non-zero
          clean_update: 5000            # Cold slot, non-zero to different non-zero
          dirty_init: 20000             # Warm slot, zero to non-zero
          dirty_update: 100             # Warm slot, non-zero to different non-zero
          dirty_reset: 100              # Warm slot, non-zero to zero
        refund_schedule:
          clear_slot: 4800              # Clearing a storage slot
          reset_to_original: 2800       # Resetting to original value
        stack_in: 2
        stack_out: 0
        description: "Save word to storage"
        eip: 2200
        note: "Most complex gas calculation - see EIP-2200 and EIP-2929"
        geth_func: opSstore

      - opcode: 0x56
        name: JUMP
        gas: 8
        stack_in: 1
        stack_out: 0
        description: "Alter the program counter"
        note: "Destination must be JUMPDEST"
        geth_func: opJump

      - opcode: 0x57
        name: JUMPI
        gas: 10
        stack_in: 2
        stack_out: 0
        description: "Conditionally alter the program counter"
        note: "Destination must be JUMPDEST"
        geth_func: opJumpi

      - opcode: 0x58
        name: PC
        gas: 2
        stack_in: 0
        stack_out: 1
        description: "Get the value of the program counter prior to increment"
        geth_func: opPc

      - opcode: 0x59
        name: MSIZE
        gas: 2
        stack_in: 0
        stack_out: 1
        description: "Get the size of active memory in bytes"
        geth_func: opMsize

      - opcode: 0x5a
        name: GAS
        gas: 2
        stack_in: 0
        stack_out: 1
        description: "Get amount of available gas"
        geth_func: opGas

      - opcode: 0x5b
        name: JUMPDEST
        gas: 1
        stack_in: 0
        stack_out: 0
        description: "Mark valid jump destination"
        geth_func: opJumpdest

      - opcode: 0x5c
        name: TLOAD
        gas: 100
        stack_in: 1
        stack_out: 1
        description: "Load word from transient storage"
        eip: 1153
        geth_func: opTload

      - opcode: 0x5d
        name: TSTORE
        gas: 100
        stack_in: 2
        stack_out: 0
        description: "Store word to transient storage"
        eip: 1153
        geth_func: opTstore

      - opcode: 0x5e
        name: MCOPY
        gas_formula: "3 + 3 * ceil(size / 32) + memory_expansion"
        stack_in: 3
        stack_out: 0
        description: "Copy memory areas"
        inputs: "[destOffset, offset, size]"
        eip: 5656
        geth_func: opMcopy

      - opcode: 0x5f
        name: PUSH0
        gas: 2
        stack_in: 0
        stack_out: 1
        description: "Push zero onto stack"
        eip: 3855
        geth_func: opPush0

  push:
    description: "Push operations (0x60-0x7f)"
    opcodes:
      - opcode: 0x60
        name: PUSH1
        gas: 3
        stack_in: 0
        stack_out: 1
        description: "Push 1-byte immediate value"
        immediate_bytes: 1
        geth_func: makePush

      - opcode: 0x61
        name: PUSH2
        gas: 3
        stack_in: 0
        stack_out: 1
        description: "Push 2-byte immediate value"
        immediate_bytes: 2
        geth_func: makePush

      - opcode: 0x62
        name: PUSH3
        gas: 3
        stack_in: 0
        stack_out: 1
        immediate_bytes: 3
        geth_func: makePush

      - opcode: 0x63
        name: PUSH4
        gas: 3
        stack_in: 0
        stack_out: 1
        immediate_bytes: 4
        geth_func: makePush

      - opcode: 0x7f
        name: PUSH32
        gas: 3
        stack_in: 0
        stack_out: 1
        description: "Push 32-byte immediate value"
        immediate_bytes: 32
        geth_func: makePush
        note: "PUSH5-PUSH31 follow same pattern (0x64-0x7e)"

  dup:
    description: "Duplication operations (0x80-0x8f)"
    opcodes:
      - opcode: 0x80
        name: DUP1
        gas: 3
        stack_in: 1
        stack_out: 2
        description: "Duplicate 1st stack item"
        geth_func: makeDup

      - opcode: 0x81
        name: DUP2
        gas: 3
        stack_in: 2
        stack_out: 3
        description: "Duplicate 2nd stack item"
        geth_func: makeDup

      - opcode: 0x8f
        name: DUP16
        gas: 3
        stack_in: 16
        stack_out: 17
        description: "Duplicate 16th stack item"
        geth_func: makeDup
        note: "DUP3-DUP15 follow same pattern (0x82-0x8e)"

  swap:
    description: "Swap operations (0x90-0x9f)"
    opcodes:
      - opcode: 0x90
        name: SWAP1
        gas: 3
        stack_in: 2
        stack_out: 2
        description: "Exchange 1st and 2nd stack items"
        geth_func: makeSwap

      - opcode: 0x91
        name: SWAP2
        gas: 3
        stack_in: 3
        stack_out: 3
        description: "Exchange 1st and 3rd stack items"
        geth_func: makeSwap

      - opcode: 0x9f
        name: SWAP16
        gas: 3
        stack_in: 17
        stack_out: 17
        description: "Exchange 1st and 17th stack items"
        geth_func: makeSwap
        note: "SWAP3-SWAP15 follow same pattern (0x92-0x9e)"

  log:
    description: "Logging operations (0xa0-0xa4)"
    opcodes:
      - opcode: 0xa0
        name: LOG0
        gas_formula: "375 + 8 * size + memory_expansion"
        stack_in: 2
        stack_out: 0
        description: "Append log with no topics"
        inputs: "[offset, size]"
        geth_func: makeLog

      - opcode: 0xa1
        name: LOG1
        gas_formula: "375 + 375 + 8 * size + memory_expansion"
        stack_in: 3
        stack_out: 0
        description: "Append log with 1 topic"
        inputs: "[offset, size, topic0]"
        geth_func: makeLog

      - opcode: 0xa2
        name: LOG2
        gas_formula: "375 + 750 + 8 * size + memory_expansion"
        stack_in: 4
        stack_out: 0
        description: "Append log with 2 topics"
        geth_func: makeLog

      - opcode: 0xa3
        name: LOG3
        gas_formula: "375 + 1125 + 8 * size + memory_expansion"
        stack_in: 5
        stack_out: 0
        description: "Append log with 3 topics"
        geth_func: makeLog

      - opcode: 0xa4
        name: LOG4
        gas_formula: "375 + 1500 + 8 * size + memory_expansion"
        stack_in: 6
        stack_out: 0
        description: "Append log with 4 topics"
        geth_func: makeLog

  system:
    description: "System operations (0xf0-0xff)"
    opcodes:
      - opcode: 0xf0
        name: CREATE
        gas: 32000
        gas_formula: "32000 + deployment_code_gas + memory_expansion"
        stack_in: 3
        stack_out: 1
        description: "Create new account with associated code"
        inputs: "[value, offset, size]"
        output: "Address of created contract or 0 on failure"
        geth_func: opCreate

      - opcode: 0xf1
        name: CALL
        gas_formula: "access_cost + positive_value_cost + value_to_empty_account_cost + memory_expansion + gas_sent_to_callee"
        gas:
          cold: 2600
          warm: 100
          positive_value: 9000
          new_account: 25000
        stack_in: 7
        stack_out: 1
        description: "Message-call into an account"
        inputs: "[gas, address, value, argsOffset, argsSize, retOffset, retSize]"
        output: "Success flag (0 or 1)"
        eip: 2929
        geth_func: opCall

      - opcode: 0xf2
        name: CALLCODE
        gas_formula: "Same as CALL"
        gas:
          cold: 2600
          warm: 100
          positive_value: 9000
        stack_in: 7
        stack_out: 1
        description: "Message-call with caller's storage context"
        note: "Deprecated in favor of DELEGATECALL"
        geth_func: opCallCode

      - opcode: 0xf3
        name: RETURN
        gas_formula: "0 + memory_expansion"
        stack_in: 2
        stack_out: 0
        description: "Halt execution returning output data"
        inputs: "[offset, size]"
        geth_func: opReturn

      - opcode: 0xf4
        name: DELEGATECALL
        gas_formula: "access_cost + memory_expansion + gas_sent_to_callee"
        gas:
          cold: 2600
          warm: 100
        stack_in: 6
        stack_out: 1
        description: "Message-call keeping caller's context (msg.sender, msg.value)"
        inputs: "[gas, address, argsOffset, argsSize, retOffset, retSize]"
        eip: 7
        geth_func: opDelegateCall

      - opcode: 0xf5
        name: CREATE2
        gas_formula: "32000 + 6 * ceil(size / 32) + deployment_code_gas + memory_expansion"
        stack_in: 4
        stack_out: 1
        description: "Create new account with deterministic address"
        inputs: "[value, offset, size, salt]"
        output: "Address = keccak256(0xff ++ sender ++ salt ++ keccak256(init_code))[12:]"
        eip: 1014
        geth_func: opCreate2

      - opcode: 0xfa
        name: STATICCALL
        gas_formula: "access_cost + memory_expansion + gas_sent_to_callee"
        gas:
          cold: 2600
          warm: 100
        stack_in: 6
        stack_out: 1
        description: "Static message-call (read-only, no state modifications)"
        inputs: "[gas, address, argsOffset, argsSize, retOffset, retSize]"
        note: "Will revert if callee tries to modify state"
        eip: 214
        geth_func: opStaticCall

      - opcode: 0xfd
        name: REVERT
        gas_formula: "0 + memory_expansion"
        stack_in: 2
        stack_out: 0
        description: "Halt execution, revert state changes, return data"
        inputs: "[offset, size]"
        eip: 140
        geth_func: opRevert

      - opcode: 0xfe
        name: INVALID
        gas: "All remaining gas"
        stack_in: 0
        stack_out: 0
        description: "Designated invalid instruction"
        geth_func: opInvalid

      - opcode: 0xff
        name: SELFDESTRUCT
        gas_formula: "5000 + cold_access_cost (if target not in access list) + new_account_cost (if target is empty and has value)"
        gas:
          base: 5000
          cold: 2600
          new_account: 25000
        stack_in: 1
        stack_out: 0
        description: "Halt execution, transfer balance to target"
        inputs: "[address]"
        note: "Deprecated in EIP-6780 (Dencun) - now only self-destructs if called in same tx as creation"
        eip: 6780
        geth_func: opSelfdestruct

# Memory expansion cost formula
memory_expansion:
  description: "Cost of expanding memory"
  formula: |
    memory_cost(new_size) - memory_cost(old_size)
    where memory_cost(s) = Gmemory * s + floor(s^2 / 512)
    and s = ceil(size / 32) (memory words)
  note: "Memory is charged quadratically to prevent DoS via memory exhaustion"

# Precompiles (0x01-0x0a)
precompiles:
  - address: "0x01"
    name: ecRecover
    gas: 3000
    description: "Elliptic curve public key recovery"

  - address: "0x02"
    name: SHA256
    gas_formula: "60 + 12 * ceil(size / 32)"
    description: "SHA-256 hash function"

  - address: "0x03"
    name: RIPEMD160
    gas_formula: "600 + 120 * ceil(size / 32)"
    description: "RIPEMD-160 hash function"

  - address: "0x04"
    name: identity
    gas_formula: "15 + 3 * ceil(size / 32)"
    description: "Identity function (data copy)"

  - address: "0x05"
    name: modexp
    gas_formula: "max(200, complexity_function)"
    description: "Modular exponentiation"
    eip: 198

  - address: "0x06"
    name: ecAdd
    gas: 150
    description: "BN256 elliptic curve point addition"
    eip: 196

  - address: "0x07"
    name: ecMul
    gas: 6000
    description: "BN256 elliptic curve scalar multiplication"
    eip: 196

  - address: "0x08"
    name: ecPairing
    gas_formula: "45000 + 34000 * k"
    description: "BN256 elliptic curve pairing check"
    eip: 197

  - address: "0x09"
    name: blake2f
    gas_formula: "rounds"
    description: "BLAKE2b F compression function"
    eip: 152

  - address: "0x0a"
    name: kzgPointEvaluation
    gas: 50000
    description: "KZG point evaluation for blob transactions"
    eip: 4844
